

#1.3 What is Node.js 

    ë¸Œë¼ìš°ì € ë°–ì—ì„œ jsë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ë§Œë“  ê²ƒ

#1.4 What is NPM  

    NPMì€ Node.jsì˜ íŒ¨í‚¤ì§€ ë§¤ë‹ˆì €, Node.jsì™€ ê°™ì´ ì„¤ì¹˜ë¨

#2.0 Your First NodeJS Project 

    .json ì€ íŒŒì¼ì— ì •ë³´ë¥¼ ì €ì¥í•˜ê¸° ìœ„í•œ ê²ƒ

    ctrl + ` ë‹¨ì¶•í‚¤ë¥¼ ëˆŒëŸ¬ terminalì„ ì—´ê³  git init ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•œë‹¤.
    githubì—ì„œ ìƒˆ repositoryë¥¼ ë§Œë“  í›„ ê²½ë¡œë¥¼ ë³µì‚¬í•œë’¤ í„°ë¯¸ë„ì— git remote and origin 'ê²½ë¡œ' ë¥¼ ì…ë ¥í•œë‹¤.
    ì´ì œ gitê³¼ ì—°ê²°ë  ê²ƒì´ê³ , gitì€ íŒŒì¼ì˜ ë³€í™”ë¥¼ ê°ì§€í•˜ëŠ” í”„ë¡œê·¸ë¨ì„ ì˜ë¯¸í•œë‹¤.
    ì´í›„ npm initì„ í„°ë¯¸ë„ì— ì…ë ¥í•œë‹¤.
    npm initì€ package.jsonì„ ìƒì„±í•˜ë©° 
    package.jsonì—ëŠ” ë‹¤ì–‘í•œ ì •ë³´ê°€ ë“¤ì–´ìˆê³ mainì€ í”„ë¡œì íŠ¸ì˜ ëŒ€í‘œíŒŒì¼ì„ ì˜ë¯¸í•œë‹¤.

#2.1 Installing Express

    package.json íŒŒì¼ì˜ scriptsì•ˆì— ì •ì˜í•œ ë‚´ìš©ì„ ì‹¤í–‰ ì‹œí‚¬ ìˆ˜ ìˆë‹¤.
    ex) "scripts": {
            "win": "node index.js"
        },

        package.jsonì´ ìˆëŠ” Terminalì—ì„œ npm run win ì…ë ¥.
        package.jsonì´ ì—†ìœ¼ë©´ ì‘ë™ ì•ˆí•¨

        npm install express ë˜ëŠ” npm i express ë¡œ íŒ¨í‚¤ì§€ ì„¤ì¹˜ ê°€ëŠ¥

        express ì„¤ì¹˜ ì‹œ ì‘ë™ì— í•„ìš”í•œ ë‹¤ë¥¸ íŒ¨í‚¤ì§€ë“¤ë„ ì„¤ì¹˜ ë¨
        expressí´ë” ë‚´ package.jsonì˜ dependenciesì—ì„œ í™•ì¸ ê°€ëŠ¥

#2.2 Understanding Dependencies

    í„°ë¯¸ë„ì—ì„œ npm ië¥¼ ì…ë ¥í•˜ë©´ package.json ì•ˆì˜ dependenciesë¥¼ ì½ì–´ì„œ ìë™ìœ¼ë¡œ ì„¤ì¹˜í•´ì¤€ë‹¤
    ê³µìœ  í”„ë¡œì íŠ¸ í• ë•Œ ëª¨ë“  íŒ¨í‚¤ì§€ë¥¼ ê³µìœ í•˜ì§€ ì•Šì•„ë„ ë˜ëŠ” ì´ì ì´ ìˆë‹¤.
    package-lock.jsonì€ íŒ¨í‚¤ì§€ë¥¼ ì•ˆì „í•˜ê²Œ ê´€ë¦¬í•´ì¤€ë‹¤. (ë²„ì „ê³¼ íŒ¨í‚¤ì§€ ëª©ë¡)
    npm install í• ë•ŒëŠ” ë°˜ë“œì‹œ package.jsonì„ ë‹«ê³  ì‹¤í–‰í•´ì•¼í•¨. -> npmì´ package.json íŒŒì¼ì„ ìˆ˜ì •í•˜ê¸° ë•Œë¬¸

#2.3 The Tower of Babel 

    nodeJSê°€ ì´í•´í•˜ì§€ ëª»í•˜ëŠ” ìµœì‹  jsë¥¼ ì“¸ë•Œ babelì„ ì‚¬ìš©í•˜ë©´ ì»´íŒŒì¼ì„ í•´ì¤Œ

    babel ì„¤ì¹˜ ë°©ë²•
    npm install --save-dev @babel/core

    package.jsonì— ë³´ë©´ devDependencies ì•ˆì— ì„¤ì¹˜ëœë‹¤.

    dependenciesëŠ” í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰ì‹œí‚¤ê¸° ìœ„í•œ package
    devDependenciesëŠ” ê°œë°œìë¥¼ ìœ„í•œ dependencies

    ì„¤ì¹˜ ì‹œ--save-devë¼ëŠ” ëª…ë ¹ì–´ì™€ ê°™ì´ ì„¤ì¹˜í•˜ë©´ devDependenciesì•ˆì— ì‘ì„±ë¨

    npm install @babel/preset-env --save-dev
    ì„¤ì¹˜ í›„ ì•„ë˜ ì‘ì—… ìˆ˜í–‰

    touch babel.config.json (touch ëª…ë ¹ì–´ëŠ” macê³¼ linuxì—ì„œ ì‘ë™ë¨)

    babel.config.json íŒŒì¼ ë‚´ë¶€ì— ì•„ë˜ì™€ ê°™ì´ ì…ë ¥ 
    {
    "presets": ["@babel/preset-env"]
    }

#2.4 Nodemon

    ë‹¤ìŒ ëª…ë ¹ì–´ë¡œ ì„¤ì¹˜. npmì´ ì´ë¯¸ ì„¤ì¹˜ë˜ì–´ ì‡ëŠ” íŒ¨í‚¤ì§€ í™•ì¸
    npm install @babel/core @babel/node --save-dev

    nodemonì€ ìš°ë¦¬ê°€ ë§Œë“  íŒŒì¼ì´ ìˆ˜ì •ë˜ì–´ ì €ì¥ë ë•Œë§ˆë‹¤ ì¬ì‹œì‘í•´ì¤€ë‹¤

    package.jsonì˜ scriptì— ë‹¤ìŒê³¼ ê°™ì´ ì‘ì„±
    "dev": "nodemon --exec babel-node index.js"
    => nodemonìœ¼ë¡œ executeí•œë‹¤. babel-nodeë¡œ index.jsë¥¼.

#3.0 Your First Server 

    codeì™€ ë¡œì§ì„ ê°€ì§€ê³  ìˆëŠ” íŒŒì¼ì„ src í´ë” ì•ˆìœ¼ë¡œ ì´ë™.

    import express from "express";
    ìœ„ì™€ ê°™ì´ ì…ë ¥í•˜ë©´ npmì´ ì•Œì•„ì„œ node_mudles í´ë”ì—ì„œ expressë¥¼ ì°¾ì•„ì¤€ë‹¤.

    ì„œë²„ë€ 24ì‹œê°„ ë‚´ë‚´ ì˜¨ë¼ì¸ì— ì—°ê²°ëœ ì»´í“¨í„°
    requestë¥¼ listening í•˜ê³  ìˆë‹¤ê°€ ì‘ë‹µì„ ë³´ë‚¸ë‹¤.

    portëŠ” ì»´í“¨í„°ì˜ network í†µë¡œë¡œ ì—¬ëŸ¬ê°œ ì¡´ì¬í•˜ë©° ë†’ì€ìˆ«ìì˜ portê°€ ë³´í†µ ë¹„ì–´ìˆë‹¤.

    app.listen(4000, handleListening);
    app.listen(4000, () => console.log());
    ìœ„ì™€ê°™ì´ ì‘ì„±í•˜ê²Œë˜ë©´ ì„œë²„ëŠ” port 4000ì„ listening í•˜ê³  ìˆëŠ” ê²ƒ

    ë¸Œë¼ìš°ì €ì— localhost:4000 ì…ë ¥í•´ì„œ ì„œë²„ì— ì ‘ì† í•  ìˆ˜ ìˆë‹¤.
    nodemon ì„œë²„ ì¢…ë£Œí•˜ë ¤ë©´ ì»¨íŠ¸ë¡¤ + c

#3.1 GET Requests

    Cannot GET / 
    GETì€ HTTP Method. HTTPëŠ” ì„œë²„ë¼ë¦¬ ì†Œí†µí•˜ëŠ” ë°©ì‹
    / ëŠ” root
    GET / ëŠ” í˜ì´ì§€ë¥¼ ë‹¬ë¼ëŠ” ì˜ë¯¸

    ì›¹ì‚¬ì´íŠ¸ì— ì ‘ì†í• ë•Œ ë¸Œë¼ìš°ì €ëŠ” ì›¹ì‚¬ì´íŠ¸ë¥¼ requestí•˜ê³  í˜ì´ì§€ë¥¼ ê°€ì ¸ë‹¤ì£¼ëŠ” ê²ƒì„.

#3.2 GET Requests part Two

    express application ì´ ë§Œë“¤ì–´ì§„ ë‹¤ìŒë¶€í„° expressì™€ ì—°ê´€ëœ ì½”ë“œë¥¼ ì‘ì„±í•´ì•¼ í•œë‹¤.
    
    requestëŠ” ì‚¬ìš©ìê°€ ì•„ë‹Œ ë¸Œë¼ìš°ì €ê°€ ë³´ë‚´ëŠ” ê²ƒì´ë‹¤.

#3.3 Responses

    ì„œë²„ ì¢…ë£Œ ë‹¨ì¶•ì–´ ctrl + c

    GET eventhandler í•¨ìˆ˜ì—ëŠ” ì•„ë˜ì™€ ê°™ì´ request, response ë‘ê°œì˜ argumentê°€ ì‹¤ë ¤ì˜¨ë‹¤.

    const handleHome = (req, res) => {};

#3.4 Recap 

    requestë¥¼ ë°›ì•˜ì„ë•Œ resondëŠ” í•„ìˆ˜. í•˜ì§€ì•Šìœ¼ë©´ ë¸Œë¼ìš°ì €ëŠ” ê³„ì† ê¸°ë‹¤ë¦¼.

#3.5 Middlewares part One

    middle softwareë€ requsetì™€ resonse ì‚¬ì´ì— ìˆëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤.

    handlerëŠ” middlewareì´ê³  controllerë¼ê³ ë„ í•œë‹¤.

    middlewareëŠ” ë‹¤ìŒ functionìœ¼ë¡œ ì‘ì—…ì„ ë„˜ê²¨ì£¼ëŠ” ê²ƒ 

#3.6 Middlewares part Two

    app.useëŠ” global middlewareë¥¼ ë§Œë“¤ ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” í•¨ìˆ˜. ëª¨ë“  URLì— ì‚¬ìš© ë¨.
    ì–´ë–¤ URLì—ë„ ì‘ë™í•˜ëŠ” middlewareë¡œ app.getì „ì— ì™€ì•¼ í•œë‹¤.
    ìˆœì„œê°€ ì˜í–¥ì„ ì£¼ê¸° ë•Œë¬¸ì— ìˆœì„œë¥¼ ìœ ì˜

    middlewareëŠ” ì¼ë°˜ì ì¸ controllerì™€ ê°™ì§€ë§Œ argumentì— next functionì´ ì¶”ê°€ëœë‹¤ëŠ” ê²ƒë§Œ ë‹¤ë¥´ë‹¤.
    app.useê°€ next(); functionì„ í˜¸ì¶œí•˜ì§€ ì•Šìœ¼ë©´ getì´ í˜¸ì¶œë˜ì§€ ì•ŠëŠ”ë‹¤

#3.7 Setup Recap 

    ëª¨ë“ ê²ƒì€ package.jsonìœ¼ë¡œë¶€í„° ì‹œì‘í•˜ê³  íŠ¹ì •ì¥ì†Œì— ë­”ê°€ë¥¼ ì…ë ¥í•˜ë©´ npmì´ ê·¸ê²ƒì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
    scriptsì—ëŠ” devë¼ëŠ” ë³„ëª…ìœ¼ë¡œ ëª…ë ¹ì–´ë¥¼ ì‰½ê²Œ ì…ë ¥í•  ìˆ˜ ìˆë„ë¡ í•œë‹¤.
    dependenciesì—ëŠ” í”„ë¡œì íŠ¸ì— í•„ìš”í•œ íŒ¨í‚¤ì§€. devDependenciesëŠ” ê°œë°œì— í•„ìš”í•œ íŒ¨í‚¤ì§€ ì‘ì„±
    node_module í´ë”ê°€ ì»¤ì§€ê¸° ë•Œë¬¸ì— gitigoreì— í¬í•¨ì‹œí‚¨ë‹¤. 
    npm i ë¥¼ í•˜ë©´ package ë‚´ìš©ì„ ì½ì–´ì„œ npmì´ í•„ìš”í•œ íŒ¨í‚¤ì§€ë¥¼ ìë™ìœ¼ë¡œ ì„¤ì¹˜í•¨.
    node.jsê°€ ìµœì‹  ì½”ë“œë¥¼ ì§€ì›í•˜ì§€ ì•Šì„ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— nodemonì„ ì‚¬ìš©.
    babel-nodeë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” babel.config.json íŒŒì¼ ë‚´ë¶€ì— presetì´ ì‘ì„±ë˜ì–´ì•¼ í•¨.

#3.8 Servers Recap

    serverë€ í•­ìƒ ì¼œì ¸ìˆê³  ì¸í„°ë„·ì— ì—°ê²°ë˜ì–´ ìˆìœ¼ë©´ì„œ requestë¥¼ listening í•˜ê³  ìˆëŠ” ì»´í“¨í„°ì´ë‹¤
    ì‚¬ìš©ìëŠ” ë¸Œë¼ìš°ì €ë¥¼ í†µí•´ requestë¥¼ ë³´ë‚¼ ìˆ˜ ìˆë‹¤.

    ì»´í“¨í„°ì—ëŠ” ë§ì€ portê°€ ìˆê³  ì•„ë˜ ì½”ë“œì²˜ëŸ¼ ì„œë²„ëŠ” í¬íŠ¸ë¥¼ í†µí•´ ë“¤ì–´ì˜¤ëŠ” requestë¥¼ listeningí•  ìˆ˜ ìˆë‹¤.
        app.listen(PORT, handleListening);
    
    ì„œë²„ëŠ” ì¢…ë£Œí•˜ì§€ ì•Šê³  í•­ìƒ listeningí•˜ê³ ìˆë‹¤. 

    ì„œë²„ì— requestê°€ ë“¤ì–´ì™”ì„ë•Œ ì‘ë™í•  í•¨ìˆ˜ë¥¼ ì—°ê²°í•´ì•¼í•¨.
     / ëŠ” í™ˆí˜ì´ì§€ë¥¼ ì˜ë¯¸í•˜ë©° /login, /lectureì™€ ê°™ì€ í†µë¡œë¥¼ routesë¼ê³  ë¶€ë¥¸ë‹¤  
    ì›¹ì‚¬ì´íŠ¸ëŠ” ë‚´ê°€ ê°€ëŠ”ê²ƒì´ ì•„ë‹ˆë¼ ë¸Œë¼ìš°ì €ê°€ ì›¹ì‚¬ì´íŠ¸ë¥¼ ì„œë²„ì—ê²Œ ë°›ëŠ”ê²ƒ
    
    expressì—ì„œëŠ” route, handler ë‘ê°œì˜ argumentë¥¼ ê°€ì§„ app.get() ì„ ì‚¬ìš©í•´ ë¸Œë¼ìš°ì €ì™€ í™ˆí˜ì´ì§€ë¥¼ ì—°ê²°í•œë‹¤.
    ex) app.get("/", handleHome)

#3.9 Controllers Recap

    handlerë¡œ ë¶€ë¥´ëŠ” controllerë“¤(middleware)ì—ëŠ” req, resë¥¼ argumentë¡œ ê°€ì§€ê³  ìˆìŒ.
    res.enn() ë˜ëŠ” res.send("I love middlewares")ë¡œ ì¢…ë£Œí•˜ê±°ë‚˜ ë©”ì„¸ì§€ë¥¼ ë³´ë‚¼ ìˆ˜ ìˆìŒ.
    expressê°€ controllerì— ì²«ë²ˆì§¸ ì¸ìˆ˜ë¡œ req, ë‘ë²ˆì§¸ë¡œ resë¥¼ ì „ë‹¬í•´ì¤€ë‹¤.

    # Server
    ì„œë²„ëŠ” ì¸í„°ë„·ì— ì—°ê²°ë˜ì–´ ìˆìœ¼ë©° 24ì‹œê°„ êº¼ì§€ì§€ ì•ŠëŠ” ì»´í“¨í„°ì´ë‹¤.
    ì„œë²„ëŠ” í´ë¼ì´ì–¸íŠ¸(ì—¬ê¸°ì„œëŠ” ë¸Œë¼ìš°ì €)ì—ì„œ ë³´ë‚¸ request ë¥¼ ë°›ê³  response ë³´ë‚¸ë‹¤.

    # Request, Response
    í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ëŠ” ê°œë°©ëœ í¬íŠ¸ë¥¼ í†µí•´ request ì™€ response ë¥¼ ì£¼ê³ ë°›ëŠ”ë‹¤.
    ì„œë²„ëŠ” request ë¥¼ ë°›ìœ¼ë©´ ë°˜ë“œì‹œ response ë¥¼ í•´ì£¼ì–´ì•¼ í•œë‹¤. ë¸Œë¼ìš°ì € ë¬´í•œ ë¡œë”©ì´ ë  ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤.
    HTTP request ëŠ” ì–´ë–¤ route(url) ì— ëŒ€í•œ HTTP Method ìš”ì²­ì´ê³  ì„œë²„ëŠ” ê·¸ ìš”ì²­ì— ëŒ€í•œ response ë¥¼ í•´ì£¼ì–´ì•¼í•œë‹¤. ì—¬ê¸°ì„œ ì¤‘ìš”í•œ ê²ƒì´ ë˜ **controller**ì´ë‹¤.

    # controller
    ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ì „ë‹¬ë°›ì€ requestë¥¼ ì²˜ë¦¬ê³  responseë¥¼ ì „ë‹¬í•˜ê¸° ìœ„í•œ ì½œë°±í•¨ìˆ˜ì´ë‹¤.

#3.10 Middleware Recap
    
    # Middleware
    ë¯¸ë“¤ì›¨ì–´ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ê°€ request ì²˜ë¦¬ ì‘ì—…ì„ ì™„ë£Œí•˜ê³  response ë¥¼ ì „ë‹¬í•˜ê¸° ì „ì— request ì²˜ë¦¬ë¥¼ ë„ì™€ì£¼ëŠ” ì½œë°±í•¨ìˆ˜ì´ë‹¤.
    ë¯¸ë“¤ì›¨ì–´ëŠ” request ì˜¤ë¸Œì íŠ¸ì™€, response ì˜¤ë¸Œì íŠ¸ ë§ê³ ë„ next íŒŒë¼ë¯¸í„°ë¥¼ ê°–ëŠ”ë‹¤.
    next íŒŒë¼ë¯¸í„°ëŠ” ë‹¤ìŒìœ¼ë¡œ request ë¥¼ ì²˜ë¦¬í•  ì½œë°±í•¨ìˆ˜ë¥¼ ë‹´ê³ ìˆê³  next()ë¥¼ í†µí•´ ë„˜ê¸¸ ìˆ˜ ìˆë‹¤.
    íŒŒë¼ë¯¸í„°ì˜ ì´ë¦„ì€ ê¼­ req, res, nextë¡œ í•  í•„ìš”ëŠ” ì—†ì§€ë§Œ ì´ë ‡ê²Œ ì“°ëŠ”ê²ƒì´ ì¼ë°˜ì ì´ë‹¤.
    ë§ˆì§€ë§‰ controllerëŠ” nextê°€ í•„ìš”ê°€ ì—†ìŒ.
    app.use(controller1, controller2, ...) ì™€ ê°™ì´ ì‚¬ìš© í•  ìˆ˜ ìˆë‹¤.

#3.11 External Middlewares

    # Morgan 
    NodeJSë¥¼ ìœ„í•œ HTTP request logger
    npm i morgan
    https://www.npmjs.com/package/morgan

#4.0 What are Routers? 

    Router 

#4.1 Making Our Routers

    í™ˆì—ì„œ ë°”ë¡œ ê°ˆìˆ˜ìˆëŠ” /join, /login ì™€ ê°™ì€ ê²ƒë“¤ì„ global router ë¼ê³  ë¶€ë¦„.

    ë§ˆì¼€íŒ… ì¸¡ë©´ì´ë‚˜ ê¹”ë”í•¨ì„ ìœ„í•´ nomadcoders.co/wetube ì™€ ê°™ì´ ì„¤ì •í•˜ê¸°ë„ í•œë‹¤.
    ë¡œì§ìƒìœ¼ë¡œëŠ” nomadcoders.co/courses/wetube

#4.1 Making Our Routers

    1. Instead using app.get([URL], [Handler]) to handle the request, we can create a router and let the router handle GET request.
    2. Create app.use("/", homeRouter) - This way, when a user sends a GET request, the request gets routed to homeRouter.
    3. Then, create a constant variable called homeRouter as below:
    const homeRouter = express.Router()
    4. Create a handler function as below:
    const handleReq = (req, res) => {res.send("Do something")}
    5. To connect the router to the handler use the code below:
    routerOne.get("/", handleReq);
    6. Then, users will get routed from the Express [app] to Router [homeRouter] to Handler function [handleReq] when users a request to get URL "/".

#4.2 Cleaning the Code 

    ì½”ë“œë¥¼ ì¼ë‹¨ ì‘ì„±í•œë‹¤. ê·¸ë¦¬ê³  ì½”ë“œë¥¼ ë‹¤ì‹œ ì •ë¦¬í•œë‹¤. (clean code ì±…)

    importëŠ” íŒŒì¼ë§ˆë‹¤ í•´ì£¼ì–´ì•¼ í•¨.

    ëª¨ë“  íŒŒì¼ì€ ëª¨ë“ˆì´ê¸° ë•Œë¬¸ì— ë‹¤ë¥¸ íŒŒì¼ì— importí•˜ê¸° ì „ì—ëŠ” exportë¥¼ í•´ì¤˜ì•¼í•¨. ì•„ë˜ì™€ ê°™ì´ ë³€ìˆ˜ë¥¼ export ê°€ëŠ¥
    export default globalRouter;

    server.jsì— ì•„ë˜ì™€ ê°™ì´ import í•´ì£¼ì–´ì•¼ í•¨.
    import userRouter from "./routers/userRouter";

    defaultë¡œ exportí•œ objectëŠ” importí•´ì„œ ì“¸ ë•Œ ë‹¤ë¥¸ ì´ë¦„ìœ¼ë¡œ ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ë‹¤.

#4.3 Exports

    defaultë¡œ export í• ë•Œì™€ëŠ” ë‹¤ë¥´ê²Œ í•¨ìˆ˜ë‚˜ ë³€ìˆ˜ë¥¼ ì§ì ‘ exportí• ë•ŒëŠ” import í•  ë•Œ ì•„ë˜ì™€ ê°™ì´ ì´ë¦„ ê·¸ëŒ€ë¡œ {} ì•ˆì— ì¨ì•¼í•¨
    import { join } from "../controllers/userController";

    jsì—ì„œëŠ” new, deleteì™€ ê°™ì€ ê¸°ë³¸í•¨ìˆ˜ë“¤ì€ ì´ë¦„ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤.

#4.4 Router Recap 

    Routerë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ ëŠ” URLì„ ì •ë¦¬í•˜ê¸° ìœ„í•¨.
    URLì´ ì–´ë–»ê²Œ ì‹œì‘í•˜ëŠ”ì§€ì— ë”°ë¼ ì‘ì„±í•œë‹¤.

#4.5 Architecture Recap

    ../ ì€ ìƒìœ„í´ë”, ./ ì€ í˜„ì¬ìœ„ì¹˜ë¥¼ ì˜ë¯¸
    terminal ëª…ë ¹ì–´ cd ëŠ” change Directoryì˜ ì¤„ì„ë§ 

#4.6 Planning Routes 

#4.7 URL Parameters part One

    : ê¸°í˜¸ë¥¼ ì‚¬ìš©íˆë¨„ URLì•ˆì— ë³€ìˆ˜ë¥¼ ë„£ì„ ìˆ˜ ìˆë‹¤.
    parameter ë¼ê³  ë¶€ë¦„. req ì•ˆì— ë‹´ê²¨ì ¸ì„œ ì˜¨ë‹¤.
    req.params

#4.8 URL Parameters part Two

    videoRouter.get("/:id", see); ì•„ë˜ì— 
    videoRouter.get("/upload", upload);
    ì´ ìˆìœ¼ë©´ /view ë¡œ ê°€ì§€ì•Šê³  ëª¨ë‘ /:id ë¡œ ì²˜ë¦¬ë¨. ìˆœì„œ ì¤‘ìš”í•¨.

    # ì •ê·œì‹ (Regular Expression)
    \w+: ëª¨ë“  ë¬¸ì, ìˆ«ì ì„ íƒ
    \d+: ëª¨ë“  ìˆ«ì ì„ íƒ

    # ì •ê·œí‘œí˜„ì‹ í…ŒìŠ¤íŠ¸ ì‚¬ì´íŠ¸
    https://www.regexpal.com

#5.0 Returning HTML

      res.send(
        "<!DOCTYPE html><html lang='ko'><head><title>Wetube</title></head><body><h1>Home</h1><footer>&copy;2021 Wetube -  All rights reserved</footer></body></html>"
        );
        
    HTMLì„ í‘œì‹œí•˜ë ¤ë©´ ìœ„ì™€ê°™ì´ ë„ˆë¬´ ê¸¸ê³  ìˆ˜ì •ì´ ë¶ˆí¸í•˜ë‹¤.
    ì´ ë•Œ ì“°ëŠ”ê²ƒì´ PUG

#5.1 Configuring Pug
    pugëŠ” ìš°ë¦¬ appì˜ view engineì´ ë  ê²ƒì„. 
    View Engine: ë·°ì—”ì§„ì€ ì„œë²„ì—ì„œ ì²˜ë¦¬í•œ ë°ì´í„° ê²°ê³¼ê°’ì„ ì •ì ì¸ í˜ì´ì§€(HTML íŒŒì¼)ì— ë³´ë‹¤ í¸ë¦¬í•˜ê²Œ ì¶œë ¥í•´ì£¼ê¸° ìœ„í•´ ì‚¬ìš©
    ë·°ì—”ì§„ì—ì„œ ìš”êµ¬í•˜ëŠ” í˜•íƒœë¡œ í…œí”Œë¦¿ íŒŒì¼(ë¬¸ì„œ)ì„ ë§Œë“¤ê³ , í•´ë‹¹ í…œí”Œë¦¿ ë¬¸ì„œì— ì„œë²„ì—ì„œ ì²˜ë¦¬í•œ ë°ì´í„°ë¥¼ ì „ë‹¬í•˜ë©´ í•´ë‹¹ ë°ì´í„°ë¥¼ í™”ë©´ì— ì¶œë ¥í•  ìˆ˜ ìˆë‹¤. //
    
    appì— view engineì´ pugì„ì„ ì•Œë ¤ì¤˜ì•¼í•¨
    server.jsì— ì•„ë˜ì™€ ê°™ì´ ì„ ì–¸
    app.set("view engine", "pug");

    views í´ë”ë¥¼ í˜„ì¬ ë””ë ‰í† ë¦¬ì— ìƒì„± í›„ home.pug íŒŒì¼ ìƒì„±

    render("view file name") ìœ¼ë¡œ ë Œë”ë§í•œë‹¤ 
    ex) export const trending = (req, res) => res.render("home");

    cwd = current working directory
    í˜„ì¬ ì‘ì—… ë””ë ‰í† ë¦¬ëŠ” node.jsë¥¼ ì‹¤í–‰í•˜ê³  ìˆëŠ” package.json íŒŒì¼ì´ ìˆëŠ” ë””ë ‰í† ë¦¬ ì´ë‹¤.
    
#5.2 Partials

    ì•„ë˜ì™€ ê°™ì´ ì…ë ¥í•˜ë©´ default Directoryë¥¼ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.
    app.set("views", process.cwd() + "/src/views");

    íŒŒì¼ëª…ì—ëŠ” ê³µë°± ã„´ã„´ ëª¨ë“  ë¬¸ìëŠ” lower caseë¡œ

    footer &copy; #{new Date().getFullYear()} Wetube
    pugëŠ” jsì´ê¸° ë•Œë¬¸ì— ìœ„ì™€ ê°™ì´ jsì½”ë“œ ì‚¬ìš© ê°€ëŠ¥.
    pugê°€ jsë¥¼ ì‹¤í–‰í•´ì„œ ìœ ì €ì—ê²Œ ì „ë‹¬í•˜ê³  ì´ë¥¼ ë Œë”ë§ ì´ë¼ê³  í•œë‹¤.

    includeëŠ” ë‹¤ë¥¸ íŒŒì¼ì„ ì²¨ë¶€í•  ìˆ˜ ìˆë‹¤. 
    pugì˜ ê°•ë ¥í•œ ê¸°ëŠ¥.
    ex) include partials/footer.pug

#5.3 Extending Templates

    extends base.pug
    ìœ„ì˜ ì½”ë“œë¡œ pug íŒŒì¼ì„ ë‹¤ë¥¸ pug íŒŒì¼ì—ì„œ ìƒì† ë°›ì„ ìˆ˜ ìˆë‹¤.

    block content
    block ì„ ì´ìš©í•˜ì—¬ base.pugì— contentë¥¼ ìœ„í•œ ê³µê°„ì„ ë§ˆë ¨í•´ë‘˜ ìˆ˜ ìˆë‹¤.

    ìƒì†ë°›ì€ íŒŒì¼ì—ì„œ ì•„ë˜ì™€ ê°™ì´ ì…ë ¥í•˜ì—¬ block ì•ˆì— contentë¥¼ ì§‘ì–´ ë„£ì„ ìˆ˜ ìˆë‹¤.
    block content  
        h1 Home!

#5.4 Variables to Templates

    pug íŒŒì¼ ë‚´ì—ì„œ #{variable} í˜•íƒœë¡œ js ë³€ìˆ˜ë¥¼ ë°›ì„ ìˆ˜ ìˆë‹¤.

    res.render("home", { pageTitle: "Home" });
    ìœ„ì™€ ê°™ì´ home.pug íŒŒì¼ì„ render í•˜ëŠ” ë¶€ë¶„ì—ì„œ ì¸ìë¡œ ë³€ìˆ˜ë¥¼ ë„˜ê²¨ì£¼ë©´ í•´ë‹¹ pug íŒŒì¼ì—ì„œ ë³€ìˆ˜ë¥¼ ë°›ëŠ”ë‹¤.

#5.5 Recap

    pugëŠ” ë„ì–´ì“°ê¸°ì™€ tabìœ¼ë¡œ êµ¬ë¶„ëœë‹¤.

    block ì€ ìƒì†ë°›ì€ íŒŒì¼ì—ì„œ ì±„ì›Œë„£ì„ ìˆ˜ ìˆëŠ” ë¹ˆ ê³µê°„.

    #{variable} ì€ js ë³€ìˆ˜ë¥¼ ë°›ì•„ë“¤ì¼ ìˆ˜ ìˆëŠ” ê³µê°„. pugë¥¼ renderí•˜ëŠ” node.js íŒŒì¼ì—ì„œ ê°™ì€ ì´ë¦„ì˜ ë³€ìˆ˜ë¥¼ ë³´ë‚´ì¤˜ì•¼í•¨

#5.6 MVP Styles

    MVP.cssëŠ” HTML íƒœê·¸ì— ê¸°ë³¸ ìŠ¤íƒ€ì¼ì„ ì‹¬ì–´ì¤Œ
    link(rel="stylesheet" href="https://unpkg.com/mvp.css")

    beutiful css ëŒ€ì‹  ê¸°ë³¸ ì„ì‹œë°©í¸

#5.7 Conditionals 

    conditionalsëŠ” if else ê°™ì€ ì¡°ê±´ì„ ì˜ë¯¸í•˜ë©°

    h1 tagì— í•œê°œì˜ variableë§Œ ì§‘ì–´ë„£ëŠ” ê²½ìš°ì—ëŠ” ì•„ë˜ì™€ ê°™ì´ ì‚¬ìš©ê°€ëŠ¥
    h1=pageTitle 
    h1 #{pageTitle} ê³¼ ê°™ë‹¤.

    ex) if fakeUser.loggedIn 
            small Hello #{fakeUser.username}

#5.8 Iteration

    # Iteration (: ë°˜ë³µ)
    arrayì™€ ê°™ì´ ë°˜ë³µì´ ê°€ëŠ¥í•œ ê²ƒë“¤ì— ëŒ€í•´ì„œ ë°˜ë³µë¬¸ì„ ì‹¤í–‰
    c#ì˜ foreachì™€ ë™ì‘ ë°©ì‹ì´ ë™ì¼í•˜ë‹¤. í•˜ì§€ë§Œ elseë¬¸ì„ null ì²´í¬ë¡œ ë°”ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

    videos arrayì˜ ë‚´ìš©ì— ëŒ€í•´ í•œë²ˆì”© ìˆ˜í–‰í•œë‹¤.
    each ë¬¸ì€ í†µìƒì ìœ¼ë¡œ each ë‹¨ìˆ˜ in ë³µìˆ˜ í˜•íƒœë¡œ ë§ì´ ì‚¬ìš©í•œë‹¤.
    ex) each video in videos 
            li=video

    pugëŠ” eachë¬¸ì— ë³€ìˆ˜ê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ì§€ ê²€ì‚¬í•œë‹¤.
    ex) each video in videos
            li=video
        else 
            li=Sorry nothing found.

#5.9 Mixins

    Mixinì€ partialê³¼ ë™ì¼í•˜ì§€ë§Œ ë°ì´í„°ë¥¼ ë°›ì„ ìˆ˜ ì‡ë‹¤.

    # mixin.pug í´ë”ì—ì„œ ë‹¤ìŒê³¼ ê°™ì´ mixinì„ ì„ ì–¸
    ex) mixin video(info)
            div
                h4=info.title
                ul  
                    li #{info.rating}/5
                    li #{info.comments} comments.
                    li Posted #{info.createAt}
                    li #{info.views} views

    # mixin.pug íŒŒì¼ì„ include í•´ì£¼ê³  ì•„ë˜ì™€ ê°™ì´ +name ìœ¼ë¡œ ì‚¬ìš©
    +video(item)

#6.0 Array Database part One

    # stringê³¼ js variable ì—°ê²°í•´ì„œ ì‚¬ìš©í•˜ëŠ” ë°©ë²•
    1. a(href="/videos/" + video.id)=video.title
    2. a(href=`/videos/${video.id}`)=video.title
    
    const { id } = req.params; ëŠ” const id = req.params.id; ì™€ ê°™ë‹¤.

#6.1 Array Database part Two

    ì¡°ê±´ë¬¸ìœ¼ë¡œ ê°’ ë„£ê¸° 
    ex) #{video.views === 1 ? "view" : "views"}

    absolute URL : URLì˜ ì•ì— / ë¥¼ ë„£ìœ¼ë©´ root + ê²½ë¡œë¡œ ê°€ê²Œë¨.
    ex) /videos í˜ì´ì§€ì—ì„œ /login ì“°ë©´ /logindìœ¼ë¡œ
    relative URL : URL ì•ì— /ë¥¼ ì•ˆì“°ë©´ í˜„ì¬ url/newURLë¡œ ê°€ê²Œë¨
    ex) /videos í˜ì´ì§€ì—ì„œ /edit ì“°ë©´ /videos/editìœ¼ë¡œ
    
    ë³€ìˆ˜ë¥¼ ë„£ì–´ì„œ URL ì´ë™
    ex) a(href=`${video.id}/edit`)--->localhost:4000/videos/1/edit

#6.2 Edit Video part One

    GETì€ 
    POST ë°©ì‹ì€ íŒŒì¼ì„ ë³´ë‚´ê±°ë‚˜ Databaseì— ìˆëŠ” ê°’ì„ ë°”ê¾¸ëŠ” ë­”ê°€ë¥¼ ë³´ë‚¼ë•Œ ì‚¬ìš©

#6.3 Edit Video part Two


    videoRouter.get("/:id(\\d+)/edit", getEdit);
    videoRouter.post("/:id(\\d+)/edit", postEdit);
    ìœ„ì˜ ë‘ì¤„ì„ ì•„ë˜ì˜ í•œ ì¤„ë¡œ ì“¸ ìˆ˜ ìˆë‹¤. í•˜ë‚˜ì˜ urlì— get post ë‘˜ë‹¤ ì“¸ ë•Œ ìœ ìš©í•¨.
    videoRouter.route("/:id(\\d+)/edit").get(getEdit).post(postEdit)

    redirect() ëŠ” ë¸Œë¼ìš°ì €ë¥¼ íŠ¹ì • urlë¡œ ì´ë™ì‹œí‚¬ ìˆ˜ ìˆìŒ.

#6.4 Recap 

    mongodb(mongoose)ë¥¼ dbë¡œ ì‚¬ìš©í•  ì˜ˆì •

#6.5 More Practice part One
#6.6 More Practice part Two

    form(method="POST", action="/videos/upload")
    actionì„ í†µí•´ formì„ ì „ë‹¬í•  URLì„¤ì • ê°€ëŠ¥. í˜„ì¬ URL defaultì´ê¸° ë•Œë¬¸ì— êµ³ì´ ì•ˆì¨ë„ ë¨.

    const { title } = req.body;
    const newVideo = {
        title,
        rating: 0,
        comments: 0,
        createAt: "just now",
        views: 0,
        id: videos.length + 1,
    };
    ìœ„ì™€ ê°™ì´ í”„ë¡œí¼í‹° ì´ë¦„ê³¼ ê°’ ëŒ€ì‹  titleë¡œë§Œ ì¨ë„ title: title, ê³¼ ê°™ìŒ

#6.7 Introduction to MongoDB 

    mongoDBëŠ” document-based. json like
    ì¼ë°˜ì ì¸ DBëŠ” SQL ê¸°ë°˜

    mongoDB ì„¤ì¹˜ ë§í¬
    https://www.mongodb.com/docs/manual/tutorial/install-mongodb-on-os-x/

#6.8 Connecting to Mongo

    mongooseëŠ” node.jsì™€ mongoDBì˜ ë‹¤ë¦¬ ì—­í• 

    Terminalì—ì„œ mongod ì…ë ¥ -> mongosh ì…ë ¥

    ì—ëŸ¬ ëœ¨ë©´
    ì¸í…”ë§¥: mongod --config /usr/local/etc/mongod.conf --fork
    M1: mongod --config /opt/homebrew/etc/mongod.conf --fork

    exit ì…ë ¥í•´ì„œ ì¢…ë£Œ

    mongosh ì…ë ¥í•´ì„œ ë‚˜ì˜¤ëŠ” urlì„ ì—°ê²°í•´ì£¼ì–´ì•¼ í•¨
    ex) db.js 
        import mongoose from "mongoose";

        mongoose.connect("mongodb://127.0.0.1:27017/wetube");   

    server.jsì— dbíŒŒì¼ import. ì´ íŒŒì¼ì€ ë°”ë¡œ ì‹¤í–‰ë¨
    ex) server.js
        import "./db";

#6.9 CRUD Introduction

    CRUDë€?
    C = Create
    R = Read
    U = Updatd
    D = Delete

    modelì„ ë§Œë“œëŠ” ì´ìœ ëŠ” dbì—ê²Œ ì„¤ëª…í•´ì£¼ê¸° ìœ„í•¨.
    ex) Videoì—ëŠ” titleì´ ìˆê³  stringì´ë‹¤. 

#6.10 Video Model 

    mongoose modelì˜ ì´ë¦„ì€ ì†Œë¬¸ìê°€ ì•„ë‹Œ ëŒ€ë¬¸ìë¡œ ì‹œì‘í•œë‹¤.
    
    # Schemas
    ëª½êµ¬ìŠ¤ì˜ ëª¨ë“  ê²ƒì€ ìŠ¤í‚¤ë§ˆë¡œ ì‹œì‘í•©ë‹ˆë‹¤.
    ê° ìŠ¤í‚¤ë§ˆëŠ” MongoDB ì»¬ë ‰ì…˜ì— ë§¤í•‘ë˜ê³  í•´ë‹¹ ì»¬ë ‰ì…˜ ë‚´ ë¬¸ì„œì˜ ëª¨ì–‘ì„ ì •ì˜í•©ë‹ˆë‹¤.
    https://mongoosejs.com/docs/guide.html#schemas

    # Models
    mongoose.model(modelName, schema):
    ëª¨ë¸ì€ ìŠ¤í‚¤ë§ˆ ì •ì˜ì—ì„œ ì»´íŒŒì¼ëœ ë©‹ì§„ ìƒì„±ìì…ë‹ˆë‹¤. ëª¨ë¸ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ documentë¼ê³  í•©ë‹ˆë‹¤. ëª¨ë¸ì€ ê¸°ë³¸ MongoDB ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ë¬¸ì„œë¥¼ ë§Œë“¤ê³  ì½ìŠµë‹ˆë‹¤.
    https://mongoosejs.com/docs/guide.html#models
    https://mongoosejs.com/docs/models.html

    db.js íŒŒì¼ì€ dbë¥¼ mongooseì™€ ì—°ê²°ì‹œì¼œì„œ video modelì„ ì¸ì‹ì‹œí‚¤ëŠ” ì—­í• ì„ í•œë‹¤.
    server.js íŒŒì¼ì— import "./db"; ë¥¼ í•¨ìœ¼ë¡œì¨ ì„œë²„ì— ì—°ê²°

#6.11 Our First Query 

    callback ì´ë€ ë¬´ì—‡ì¸ê°€ ë°œìƒí•˜ê³  ë‚œ ë‹¤ìŒ í˜¸ì¶œë˜ëŠ” functionì„ ì˜ë¯¸í•¨. 
    
#6.12 Our First Query part Two

    M1 ë§¥ ( ì—ëŸ¬í•´ê²° )
    Error: couldn't connect to server 127.0.0.1:27017, connection attempt failed: SocketException: Error connecting to 127.0.0.1:27017 :: caused by :: Connection refused :
    connect@src/mongo/shell/mongo.js:372:17

    (*****)
    ì œê°€ ê²ªì€ ëª¨ë“  ì—ëŸ¬ë“¤ê³¼ í•´ê²°ê³¼ì • ì¢…í•©í•´ì„œ ì •ë¦¬í•´ë³´ì•˜ìŠµë‹ˆë‹¤.
    m1ì´ íŒŒì¼ ì €ì¥ê²½ë¡œê°€ ë‹¬ë¼ì„œ ë¹™ë¹™ ëŒì•˜ì—ˆë„¤ìš”..
    mongo ì‚¬ìš©í›„ ì—ëŸ¬ ë‚˜ì˜¤ì‹œëŠ”ë¶„ë“¤ì€ ê¼­ mongod ì‹¤í–‰ í›„ ì—ëŸ¬ì½”ë“œ í™•ì¸í•´ë³´ì‹œê¸¸ ë°”ëë‹ˆë‹¤.


    1. mongodbê°€ ì¼œì ¸ìˆëŠ”ì§€ í™•ì¸
    brew services list >> mongodb ì‹¤í–‰ì¤‘ì¸ì§€ í™•ì¸
    brew services run mongodb-community >> ì„œë²„ì‹¤í–‰
    + stop (ì¢…ë£Œ) , restart(ì¬ì‹œì‘)

    2. background process ì„¤ì •
    mongod --config /opt/homebrew/etc/mongod.conf --fork

    --config : ì„¤ì •í•˜ë‹¤
    /opt/homebrew/etc/mongod.conf : mongodb Configuration file ìœ„ì¹˜
    --fork: daemon ëª¨ë“œ ì„¤ì •
    ì°¸ê³  : https://docs.mongodb.com/manual/reference/configuration-options/

    3. mongo ì˜¤ë¥˜ì‹œ mongod ì‹¤í–‰í›„ error ì½”ë“œ í™•ì¸í•˜ê¸° (***)

    3-1. dbpath error ì½”ë“œ ë°œìƒì‹œ
    mongodbëŠ” dbpath ê²½ë¡œì— directory(íŒŒì¼)ì´ ìƒì„±ë˜ì–´ ìˆì–´ì•¼ ì‘ë™í•œë‹¤.
    mongodb default dbpath ëŠ” /data/db ì´ë‹¤.

    sudo mkdir /data/db

    sudo: ì‚¬ìš©ìê¶Œí•œ ì‚¬ìš©
    mkidir: ë‹¤ì´ë ‰í† ë¦¬ ìƒì„±
    /data/db: mongodb dbpath default ê²½ë¡œ

    mongod --dbpath /data/db : mongod dbpath ì„¤ì •í•´ì£¼ê¸°

    dbpath ì„¤ì •ê¹Œì§€ ì™„ë£Œí–ˆë‹¤ë©´ brew services restart mongodb-community

    ì‹¬í™” ( dbpath ë‹¤ë¥¸ê³³ì— ì„¤ì •í•˜ê¸° )
    vi /opt/homebrew/etc/mongod.conf ( mongod.conf íŒŒì¼ ì ‘ì† )


    vi CLI ê°€ ë¨¹íˆì§€ ì•Šì„ì‹œ
    export PATH=%PATH:/bin:/usr/local/bin:/usr/bin
    ì°¸ê³ : https://keepdev.tistory.com/67

    CLIë¡œ í¸ì§‘í•˜ê¸°
    o( insert mode ) > ìˆ˜ì • í›„ > esc ì—°íƒ€ > :wq ( íŒŒì¼ ë‚˜ê°€ê¸° )

    storage:
    dbpath: ( ì›í•˜ëŠ” path ì…ë ¥ )

    í˜¹ì€ finder ì—ì„œ command + shift + g > /opt/homebrew/etc/mongod.conf ê²€ìƒ‰

    mongod.conf ì—ì„œ dbpath ì„¤ì •ì„ ë§ˆì³¤ë‹¤ë©´
    source /opt/homebrew/etc/mongod.cof
    source : ì €ì¥ í›„ ì‹¤í–‰

    ë‹¤ì‹œ í•œ ë²ˆ ë” mongod --dbpath (ë³€ê²½ëœ ê²½ë¡œ)

    (mongod --dbpath ë¡œ ì„ì‹œë¡œ ê²½ë¡œ ë³€ê²½ì„ í•  ìˆ˜ ìˆì§€ë§Œ ë‹¤ì‹œ í‚¬ë•Œë§ˆë‹¤ ì˜êµ¬ì ìœ¼ë¡œ ì„¤ì •í•´ì£¼ë ¤ë©´ mongod.conf íŒŒì¼ì—ì„œ dbpathë¥¼ ë°”ê¾¸ì–´ì£¼ì–´ì•¼í•©ë‹ˆë‹¤.)

    3-2 ì†Œì¼“ ì˜¤ë¥˜ ë°œìƒì‹œ (mongod ì—ì„œ í™•ì¸)
    failed to unlink socket file","attr":{"path":"/tmp/mongodb-27017.sock","error":"permission denied"

    /tmp/mongodb-27017.sock íŒŒì¼ ì œê±°í•´ì£¼ë©´ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•©ë‹ˆë‹¤.

    sudo rm -rf /tmp/mongodb-27017.sock

    rm : remove file
    -r : ë””ë ‰í† ë¦¬ì œê±°ê°€ëŠ¥
    -f : í™•ì¸ì—†ì´ ì œê±°

    brew services restart mongodb-community

    ì°¸ê³  : https://stackoverflow.com/questions/63562177/mongod-aborts-on-mac

    Documentation:
    https://docs.mongodb.com/manual/tutorial/install-mongodb-on-os-x/

#6.13 Async Await 

    ex) call back ì‚¬ìš© videoContoroller.js
        console.log("start")
        //Video.find({}, (error, videos) => {
            return res.render("home", { pageTitle: "Home", videos });
        });
        console.log("finished")

    promiseëŠ” callbackì˜ ìµœì‹  ë²„ì „ì´ë¼ê³  ìƒê°í•˜ë©´ ë¨. => async await
    jsëŠ” ê¸°ë‹¤ë¦¬ëŠ” ê¸°ëŠ¥ì´ ì—†ê¸° ë•Œë¬¸ì— callbackì„ ì¼ì§€ë§Œ
    await ë¡œ ìˆ˜í–‰ë ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¬ëŠ”ê²ƒì„ ì§ê´€ì ìœ¼ë¡œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
    awaitì´ ë“¤ì–´ìˆëŠ” functionì„ async ë¡œ ë¹„ë™ê¸°ë¡œ ì²˜ë¦¬í•  ê²ƒì„ ì•Œë ¤ì¤˜ì•¼ë§Œ awaitì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

    async await ë°©ì‹ì€ ì–´ë””ì„œ ë¬´ì—‡ì´ ì˜¤ëŠ”ì§€ ëª…í™•í•˜ê¸° ì•ˆí•˜ê¸° ë–„ë¬¸ì— ë‘ê°€ì§€ ì˜µì…˜ ì‚¬ìš©
    # 1. try catch ë¬¸ìœ¼ë¡œ try ì½”ë“œ ì‹¤í–‰ ì¤‘ ì˜¤ë¥˜ ë°œìƒ ì‹œ catch ë¬¸ìœ¼ë¡œ ì´ë™í•˜ê³  í•´ë‹¹ errorë¥¼ íŒŒë¼ë¯¸í„°ë¡œ ì‚¬ìš© í•  ìˆ˜ ìˆë‹¤.
    ex) videoContoroller.js 
        try {
        const videos = await Video.find({});
        console.log(videos);
        return res.render("home", { pageTitle: "Home", videos });
        } catch (error) {
            return res.render("server-error", { error });
        }

#6.14 Returns and Renders   

    res.render ë¥¼ ë‘ë²ˆ í•˜ê²Œë˜ë©´ ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤. renderí•œ ê²ƒì€ ë‹¤ì‹œ renderí•  ìˆ˜ ì—†ìŒ
    - redirect(), sendStatus(), end() ë“±ë“± í¬í•¨ (expressì—ì„œ ì˜¤ë¥˜ ë°œìƒ)
    
    return ìì²´ê°€ í•„ìˆ˜ ìš”ì†ŒëŠ” ì•„ë‹ˆì§€ë§Œ res.render ì´í›„ì— res ì„ ì‚¬ìš©í•˜ë©´ ì–´ì§œí”¼ ì—ëŸ¬ê°€ ë‚˜ê¸° ë•Œë¬¸ì—
    ì—ëŸ¬ê°€ ë‚˜ê¸°ì „ì— returnìœ¼ë¡œ functionì„ ì¢…ë£Œí•´ ì£¼ëŠ” ê²ƒì„. 
    -> return ì€ ì‹¤ìˆ˜ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ functionì„ ë§ˆë¬´ë¦¬ ì§“ëŠ” ì—­í• ë¡œ ì‚¬ìš© í•˜ëŠ” ê²ƒ

    callback í˜•íƒœë¡œ ì‚¬ìš©ì‹œ callback í•¨ìˆ˜ê°€ ìƒìœ„ function ì´í›„ì— ì‹¤í–‰ë˜ê¸° ë•Œë¬¸ì— return ìˆœì„œì— í—·ê°ˆë¦´ ìˆ˜ ìˆìŒ.
    ex) videoContoroller.js
        export const home = (req, res) => {
        Video.find({}, (error, videos) => {
            return res.render("home", { pageTitle: "Home", videos });
        });
        return res.end();
        };

#6.15 Creating a Video part One 

    formì˜ inputì—ëŠ” ê°ê¸° ë‹¤ë¥¸ nameì„ ë¶€ì—¬í•´ì¤˜ì•¼ í•¨.

    split(",") í•¨ìˆ˜ë¥¼ ì´ìš©í•´ , ë¥¼ ê¸°ì¤€ìœ¼ë¡œ stringì„ arrayë¡œ ë°›ì„ ìˆ˜ ìˆë‹¤.

    map í•¨ìˆ˜ë¥¼ ì´ìš©í•´ ë‹¨ì–´ ì•ì— # ì¶”ê°€
    ex) hasgtags: hashtags.split(",").map((word) => `#${word}`),

#6.16 Creating a Video part Two

    mongooseëŠ” string íƒ€ì…ì— numberë¥¼ ë„£ì–´ë„ ìë™ìœ¼ë¡œ stringìœ¼ë¡œ ë³€í™˜í•´ ì¤€ë‹¤.

    ë°ì´í„°ì˜ í˜•íƒœë¥¼ ë¯¸ë¦¬ ì •ì˜í•´ë‘ê³  ì˜ëª»ëœ ì •ë³´ë¥¼ ê¸°ë¡í•˜ë©´ mongooseê°€ ë°ì´í„° íƒ€ì…ì˜ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ ë„ì™€ì¤€ë‹¤.

    save() fuctionì€ promiseë¥¼ return í•´ì¤€ë‹¤.
    dbì— save í•˜ëŠ”ë° ì‹œê°„ì´ ê±¸ë¦¬ê¸° ë•Œë¬¸ì„.
    ì´ ë§ì€ saveê°€ ì‹¤í–‰ë˜ê¸°ê¹Œì§€ ê¸°ë‹¤ë ¤ì¤˜ì•¼ í•œë‹¤ëŠ” ëœ»ì´ë‹¤. ë”°ë¼ì„œ async await ì²˜ë¦¬ í•„ìš”
    ex) videoContoroller.js

        export const postUpload = async (req, res) => {
            const { title, description, hashtags } = req.body;
            const video = new Video({
                title,
                description,
                createdAt: Date.now(),
                hasgtags: hashtags.split(",").map((word) => `#${word}`),
                meta: {
                views: 0,
                rating: 0,
                },
            });
            const dbVideo = await video.save();

        ì•„ë˜ ì½”ë“œì™€ ìœ„ ì½”ë“œì˜ ê²°ê³¼ëŠ” ê°™ë‹¤.

        await video.create({
        title,
        description,
        createdAt: Date.now(),
        hasgtags: hashtags.split(",").map((word) => `#${word}`),
        meta: {
        views: 0,
        rating: 0,
        },
        });

    databaseëŠ” ìš°ë¦¬ê°€ ë°ì´í„°ë¥¼ ì˜ëª» ì…ë ¥í–ˆì„ë•Œ ì˜¤ë¥˜ë¥¼ ë°œìƒì‹œì¼œì¤Œ.

#6.17 Exceptions and Validation

    mongoDBë¥¼ ë””í…Œì¼í•˜ê²Œ ì •ì˜ í•  ìˆ˜ë¡ validation í•˜ê¸° ìœ ìš©í•˜ë‹¤.

    schemaì— ë¯¸ë¦¬ default ê°’ì„ ì •í•´ë†“ê³  ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
    ex) Video.js

        const videoSchema = new mongoose.Schema({
        title: { type: String, required: true },
        description: { type: String, required: true },
        createdAt: { type: Date, required: true, default: Date.now },
        hashtags: [{ type: String }],
        meta: {
            views: { type: Number, default: 0, required: true },
            rating: { type: Number, default: 0, required: true },
        },
        });
        
    createdAt ì— date.now()ê°€ ì•„ë‹Œ date.now ë¡œ ì“°ëŠ” ì´ìœ ëŠ” ë°ì´í„°ê°€ ìƒì„±ë ë•Œë§Œ ì‹¤í–‰ë˜ë„ë¡ í•˜ê¸° ìœ„í•´ì„œ

#6.18 More Schema

    https://mongoosejs.com/docs/schematypes.html

    trim: true ì˜µì…˜ìœ¼ë¡œ stringì‚¬ì´ì˜ ê³µë°±ì„ ì œê±° í•  ìˆ˜ ìˆë‹¤.
    ex) Video.js
        title: { type: String, required: true, trim: true },

    htmlì™€ dbì—ì„œ ëª¨ë‘ ìµœì†Œ, ìµœëŒ€ ê¸€ìë¥¼ ì œí•œí•´ì•¼ ë³´ì•ˆì— ë¬¸ì œê°€ ì—†ìŒ.

#6.19 Video Detail

    Hexadecimal ì€ 16ì§„ìˆ˜ ( 0~9 ê¹Œì§€ì˜ ìˆ«ìì™€ 6ê°œì˜ ê¸°í˜¸(A-F)ë¡œ ì´ë£¨ì–´ì§)

    ì •ê·œì‹ ì—°ìŠµ ì‚¬ì´íŠ¸ 
    https://regex101.com/

    24ìë¦¬ 16ì§„ìˆ˜ id ì •ê·œì‹ ì ìš© 
    ex) videoRouter.get("/:id([0-9a-f]{24})", watch);

    expressì˜ findById functionì„ ì‚¬ìš©í•´ videoë¥¼ ë°›ì•„ì˜¬ ìˆ˜ ìˆë‹¤.
    ex) videoController.js
        const video = await Video.findById(id);

#6.20 Edit Video part One 

    mongooseë‚´ë¶€ì ìœ¼ë¡œ exec() ë¥¼ ì‹¤í–‰ì‹œí‚¤ë©´  

    ëˆ„êµ°ê°€ê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” video idë¡œ ì ‘ê·¼í–ˆì„ë•Œì˜ ì²˜ë¦¬ê°€ í•„ìš”í•¨
    ex) videoContoroller.js
        if (video) {
            return res.render("watch", { pageTitle: video.title, video });
        }
        return res.render("404", { pageTitle: "Video not found." });

    ë‹ˆì½”ìŒ¤ì€ ì½”ë”©í•  ë•Œ ì—ëŸ¬ë¥¼ ë¨¼ì € ì²˜ë¦¬í•¨. 
    if êµ¬ë¬¸ì—ì„œëŠ” returní•˜ê³  ì•„ë˜ì—ì„œëŠ” ì—ëŸ¬ê°€ ë‚˜ì§€ ì•Šì•˜ì„ë•Œ ì½”ë“œë¥¼ ê³„ì†í•´ì„œ ì‘ì„±
    ex) videoContoroller.js
        if (!video) {
            return res.render("404", { pageTitle: "Video not found." });
        } 

    ë°°ì—´ì„ í•˜ë‚˜ì˜ ìŠ¤íŠ¸ë§ìœ¼ë¡œ í•©ì¹˜ëŠ” function : join()

#6.21 Edit Video part Two

    hashtagsê°€ #ìœ¼ë¡œ ì‹œì‘í•˜ëŠ”ì§€ì— ë”°ë¥¸ ì²˜ë¦¬
    ex) videoContoroller.js
        video.hashtags = hashtags.split(",").map((word) => word.startsWith('#') ? word :`#${word}`);

#6.22 Edit Video part Three

    mongooseì˜ function ì¤‘ì— findByidAndUpdat() ë¡œ ì°¾ì€ë’¤ ì—…ë°ì´íŠ¸ í•´ì¤„ ìˆ˜ ìˆë‹¤.
    ex) videoContoroller.js
        await Video.findByIdAndUpdate(id, {
            title,
            description,
            hasntags: hashtags
            .split(",")
            .map((word) => (word.startsWith("#") ? word : `#${word}`)),
        });

    ëŒ€ë¬¸ì VideoëŠ” Model, ì†Œë¬¸ì videoëŠ” object

    exist() functionì€ filter(ì–´ë–¤ì¡°ê±´ì´ë“  ê°€ëŠ¥)ë¥¼ ë°›ê³  ì¡´ì¬ ì—¬ë¶€ì— ë”°ë¼true ë˜ëŠ” falseë¥¼ ë°˜í™˜.
    ex) videoContoroller.js
        const video = await Video.exists({ _id: id });

#6.23 Middlewares 

    Mongoose MiddlewareëŠ” ëª¨ë¸ì´ ìƒì„±ë˜ê¸° ì „ì— ë§Œë“¤ì–´ì¤˜ì•¼í•¨.

    ì•„ë˜ì™€ ê°™ì´ .pre() functionìœ¼ë¡œ save ì „ì— ì‹¤í–‰ì‹œì¼œì¤„ ë¯¸ë“¤ì›¨ì–´ë¥¼ ì„¤ì • í•  ìˆ˜ ìˆë‹¤.
    ex) Video.js
        videoSchema.pre("save", async function () {
            console.log("We are about to save :", this);
        });

    cmd
    1. ëª½ê³  ì‚¬ìš©í•˜ê¸°
    > mongod > mongosh
    
    2. ë‚´ê°€ ê°€ì§„ db ë³´ê¸°â€¨
    > show dbs

    3. í˜„ì¬ ì‚¬ìš© ì¤‘ì¸ db í™•ì¸â€¨
    > db

    4. ì‚¬ìš©í•  db ì„ íƒí•˜ê¸°â€¨
    > use dbName
    (í˜„ì¬ ìˆ˜ì—…ì—ì„œëŠ” `use wetube`)

    5. db ì»¬ë ‰ì…˜ ë³´ê¸°â€¨
    > show collections

    6. db ì»¬ë ‰ì…˜ ì•ˆì— documents ë³´ê¸°
    >â€¨ db.collectionName.find()
    (í˜„ì¬ ìˆ˜ì—…ì—ì„œëŠ” `db.videos.find()`)

    7. db ì»¬ë ‰ì…˜ ì•ˆì— documents ë‚´ìš© ëª¨ë‘ ì œê±°í•˜ê¸°â€¨
    > db.collectionName.remove({})

    (í˜„ì¬ ìˆ˜ì—…ì—ì„œëŠ” `db.videos.remove({})`)
    
#6.24 Statics 

    findByIdAndUpdate ëŠ” middlewareë¡œ ë°ì´í„°ì— ì ‘ê·¼ í•  ìˆ˜ê°€ ì—†ë‹¤.

    hashtags ë¥¼ foramtting í•˜ëŠ” ë¶€ë¶„ì´ ì¤‘ë³µìœ¼ë¡œ ë‚˜ì˜¤ê³  ìˆìœ¼ë‹ˆ Video Schemaì— Static functionìœ¼ë¡œ í•˜ë©´ í¸ë¦¬í•  ê²ƒì´ë‹¤.
    ex) Video.js
        videoSchema.static("formatHashtags", function (hashtags) {
        return hashtags
            .split(",")
            .map((word) => (word.startsWith("#") ? word : `#${word}`));




        });

#6.25 Delete Video

    Model.findByIdAndDelete function ë¥¼ ì´ìš©í•´ ë°ì´í„° ì‚­ì œ
    ex) videoContoroller.js
        export const deleteVideo = async (req, res) => {
            const { id } = req.params;
            await Video.findByIdAndDelete(id);
            return res.redirect("/");
        };

#6.26 Search part One

    MongooseëŠ” í›Œë¥­í•œ Query ì—”ì§„ì„ ê°€ì§€ê³  ìˆë‹¤. ê²€ìƒ‰, ì •ë ¬ ë“± ê°€ëŠ¥

    sort() fucntionìœ¼ë¡œ ì •ë ¬í•  ìˆ˜ ìˆë‹¤. desc : ë‚´ë¦¼ì°¨ìˆœ,  asc : ì˜¤ë¦„ì°¨ìˆœ
    ex) videoContoroller.js
        const videos = await Video.find({}).sort({ createdAt: "desc" });

    # ì „ë‹¬ëœ valueë¥¼ ë°›ëŠ” ë°©ë²•
        ë¼ìš°í„°ë¡œ ì§€ì •í•œ :id -> req.params
        pugíŒŒì¼ì—ì„œ inputìœ¼ë¡œ ë°›ì€ ë‚´ìš© -> req.body(formì´ POSTì¼ ë•Œ)
        pugíŒŒì¼ì—ì„œ inputìœ¼ë¡œ ë°›ì€ urlë‚´ìš© -> req.query (formì´ GETì¼ ë•Œ)   
    
        ex) videoContoroller.js
            export const search = (req, res) => {
                const { keyword } = req.query;
                return res.render("search", { pageTitle: "Search" });
            };

    ì‚¬ìš©ìê°€ ì²˜ìŒ search í˜ì´ì§€ì— ì˜¬ ë•ŒëŠ” req.queryì— ê°’ì´ undefined

#6.27 Search part Two 

    Regular Expressionì„ ì‚¬ìš©í•´ì„œ ê²€ìƒ‰
    ëª½ê³ DB regex ($regex)
    ëª½ê³ DBì—ì„œ ì •ê·œí‘œí˜„ì‹ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•˜ëŠ” í‚¤ì›Œë“œ
    ì¿¼ë¦¬ì˜ íŒ¨í„´ ì¼ì¹˜ ë¬¸ìì—´ì— ëŒ€í•œ ì •ê·œì‹ ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.
    https://docs.mongodb.com/manual/reference/operator/query/regex

    ë¬¸ìì—´ ì¤‘ì— keywordê°€ í¬í•¨ë˜ì–´ìˆëŠ” ê²ƒì„ ì°¾ëŠ” ì½”ë“œ. "i"ëŠ” ëŒ€ì†Œë¬¸ì êµ¬ë¶„ í•˜ì§€ì•ŠìŒì„ ëœ»í•¨.
    ex) videoContoroller.js
        videos = await Video.fin({
            title: {
                $regex: new RegExp(keyword, "i"),
        },
      
#6.28 Conclusions

#7 USER AUTHENTICATION

#7.0 Create Account part One 

    User Schemaë¥¼ ìƒì„±
    User.js 

#7.1 Create Account part Two

    DeprecationWarning ê²½ê³ ê°€ ëœ¨ë©´
    db.js - mongoose.connect() ì— useCreateIndex: true ì¶”ê°€í•´ì£¼ë©´ ë¨.

    í˜„ì¬ user db í™•ì¸ë°©ë²•
    terminal -> mongod -> mongosh -> use wetube -> show collections -> db.users.find()

#7.2 Creating Account part Three

    ë…¸ë§ˆë“œ ì½”ë” í•´ì‹œí•¨ìˆ˜ 5ë¶„ ì„¤ëª… : https://www.youtube.com/watch?v=67UwxR3ts2E
    
    í•´ì‹œí•¨ìˆ˜ëŠ” ì…ë ¥ì„ í•˜ë©´ ì¶œë ¥ê°’ì´ ë‚˜ì˜¤ëŠ”ë° ì¶œë ¥ê°’ìœ¼ë¡œëŠ” ì…ë ¥ê°’ì„ ì•Œì•„ë‚¼ ìˆ˜ ì—†ê³  ê°™ì€ ì…ë ¥ê°’ìœ¼ë¡œëŠ” ê°™ì€ ì¶œë ¥ê°’ì´ ë‚˜ì˜¨ë‹¤.

    í•´ì‹œí•¨ìˆ˜ í…ŒìŠ¤íŠ¸
    https://emn178.github.io/online-tools/sha256.html

    bcrypt ë¼ëŠ” í•´ì‹±í•¨ìˆ˜ë¥¼ ì‚¬ìš© í•  ê²ƒì„ : https://www.npmjs.com/package/bcrypt
    >> npm i bcrypt

    rainbow rable ê³µê²©ì„ bcryptê°€ ë§‰ì•„ì¤Œ.

    bcrypt.hash(funtion, í•´ì‹± íšŸìˆ˜) í˜•íƒœë¡œ ì‚¬ìš©í•œë‹¤. promiseë¥¼ ì§€ì›í•œë‹¤.
    ex) User.js
    userSchema.pre("save", async function () {
        this.password = await bcrypt.hash(this.password, 5);
    });

    ìœ„ì—ì„œ this ëŠ” user.createí•œ ì˜¤ë¸Œì íŠ¸ë¥¼ ì˜ë¯¸í•¨. 

#7.3 Form Validation

    ì´ë¯¸ ì¡´ì¬í•˜ëŠ” email, username ìœ¼ë¡œ userë¥¼ ìƒì„±í–ˆì„ ë•Œ duplicate key error ë°œìƒ.
    

    ì•„ë˜ì™€ ê°™ì´ ì‚¬ìš©ì‹œ usernameê³¼ emailì´ ë‘ê°œ ëª¨ë‘ ì¤‘ë³µì¼ë•Œë§Œ true
    ex) userController.js
        const usernameExists = await User.exists({ username, email });

    $or operatorë¥¼ ì‚¬ìš©í•´ì„œ ì¡°ê±´ì„ ì—¬ëŸ¬ê°œ ì²´í¬
    ex) userController.js
        const exits = await User.exists({ $or: [[username], { email }] });

#7.4 Status Codes 
    ìƒíƒœì½”ë“œ
    - 200(OK): ì„œë²„ê°€ ìš”ì²­ì„ ì œëŒ€ë¡œ ì²˜ë¦¬í–ˆë‹¤ëŠ” ëœ»ì´ë‹¤. ì´ëŠ” ì£¼ë¡œ ì„œë²„ê°€ ìš”ì²­í•œ í˜ì´ì§€ë¥¼ ì œê³µí–ˆë‹¤ëŠ” ì˜ë¯¸ë¡œ ì“°ì¸ë‹¤.
    - 400(Bad Request): ì„œë²„ê°€ ìš”ì²­ì˜ êµ¬ë¬¸ì„ ì¸ì‹í•˜ì§€ ëª»í•  ë•Œ ë°œìƒí•œë‹¤. í´ë¼ì´ì–¸íŠ¸ ì¸¡ì—ì„œ ë¬¸ì œê°€ ìˆì„ ë•Œ ì£¼ë¡œ ë°œìƒí•œë‹¤.
    - 404(Not Found): ì„œë²„ê°€ ìš”ì²­í•œ í˜ì´ì§€ë¥¼ ì°¾ì„ ìˆ˜ ì—†ì„ ë•Œ ë°œìƒí•œë‹¤. ì„œë²„ì— ì¡´ì¬í•˜ì§€ ì•ŠëŠ” í˜ì´ì§€ì— ëŒ€í•œ ìš”ì²­ì´ ìˆì„ ê²½ìš° ì„œë²„ëŠ” ì´ ì½”ë“œë¥¼ ì œê³µí•œë‹¤.
    https://ko.wikipedia.org/wiki/HTTP_%EC%83%81%ED%83%9C_%EC%BD%94%EB%93%9C


    responseì— ëŒ€í•œ HTTP ìƒíƒœë¥¼ ì„¤ì •í•©ë‹ˆë‹¤. (statusë¥¼ ì„¤ì •í•œë‹¤.)
    res.status(code)
    https://expressjs.com/ko/api.html#res.status
    https://nodejs.org/api/http.html#http_response_statuscode

    ì—ëŸ¬ê°€ ìˆì„ë• resì™€ renderì‚¬ì´ì— 4xx client error ì½”ë“œë¥¼ ë³´ë‚´ì„œ ì‚¬ìš©í•œë‹¤
    ex) userController.js
        return res.status(400).render

    ë¸Œë¼ìš°ì €ëŠ” ë°©ë¬¸í•œ ì›¹ì‚¬ì´íŠ¸ì˜ íˆìŠ¤í† ë¦¬ë¥¼ ì €ì¥í•˜ëŠ”ë° 4xx ì—ëŸ¬ë¥¼ ë°›ìœ¼ë©´ ì €ì¥í•˜ì§€ ì•ŠìŒ.

#7.5 Login part One

    userController ì—ì„œ ì—ëŸ¬ë¥¼ ì²˜ë¦¬í•˜ê³  ë”ìš± ì•ˆì „í•˜ê²Œ create ë¬¸ì—ì„œ try catch ë¬¸ì„ ì‚¬ìš© í•  ìˆ˜ ìˆë‹¤.
    
#7.6 Login part Two

    login í•  ë•Œ ì…ë ¥í•œ passwordë¥¼ í•´ì‹±í•´ì„œ dbì˜ passwordì™€ ë¹„êµí•´ì„œ ìœ ì € í™•ì¸ë°©ë²•

    bcrypt ì— ë‚´ì¥ëœ í•¨ìˆ˜ compareë¥¼ ì‚¬ìš©í•´ì„œ ë¹„êµí•œë‹¤.

#7.7 Sessions and Cookies part One

    ì„¸ì…˜ì€ ë¸Œë¼ìš°ì €ì™€ ë°±ì—”ë“œ ì‚¬ì´ì˜ memory, history ê°™ì€ ê²ƒ
    ì´ê²Œ ì‘ë™í•˜ë ¤ë©´ ë°±ì—”ë“œì™€ ë¸Œë¼ìš°ì €ê°€ ì„œë¡œì— ëŒ€í•œ ì •ë³´ë¥¼ ê°€ì§€ê³  ìˆì–´ì•¼ í•¨.

    í•œë²ˆ ìš”ì²­ì„ ë°›ê³  ì²˜ë¦¬ê°€ ëë‚˜ë©´ ì„œë²„ì™€ ë¸Œë¼ìš°ì €ì˜ ì—°ê²°ì€ ëŠì–´ì§€ëŠ”ë° ì´ê²ƒì„ statelessë¼ê³  í•¨. 

    ìœ ì €ê°€ ë¡œê·¸ì¸ í•  ë•Œ ìœ ì €ì—ê²Œ í…ìŠ¤íŠ¸(ì¿ í‚¤)ë¥¼ ì¤€ë‹¤.

    npm i express-session ì„¤ì¹˜
    
    router ì´ì „ì— use
    ex) server.js 
        app.use(
            session({
                secret: "Hello!",
                resave: true,
                saveUninitialized: true,
            })
        );

    express-session middlewareê°€ ì„œë²„ë¡œ ë“¤ì–´ì˜¤ëŠ” ëª¨ë“ ì‚¬ëŒì„ ì•Œ ìˆ˜ ìˆë‹¤.
    ë°±ì—”ë“œëŠ” ìš”ì²­ì´ ìˆì„ë•Œ ì¿ í‚¤ë¥¼ ë¸Œë¼ìš°ì €ì—ê²Œ ë³´ë‚´ê³  ë¸Œë¼ìš°ì €ëŠ” ìƒˆë¡œê³ ì¹¨ í•  ë•Œë§ˆë‹¤ cookieë¥¼ ìë™ìœ¼ë¡œ ë³´ë‚¸ë‹¤.

#7.8 Sessions and Cookies part Two

    ë¸Œë¼ìš°ì €ë§ˆë‹¤ ê°ê°ì˜ ì„¸ì…˜ì´ ì¡´ì¬í•œë‹¤. 
    ì„œë²„ê°€ ì„¸ì…˜ì„ ìƒì„±í•œ ê¸°ì ì€ middlewareë¡œ express-sessionì„ ì¶”ê°€í–ˆì„ë•Œë¶€í„° ìƒì„±ë¨.
    ì„¸ì…˜ì€ ì„œë²„ì¸¡ì—ì„œ ì œê³µí•´ì£¼ëŠ” ë°ì´í„°, ì¿ í‚¤ëŠ” í´ë¼ì´ì–¸íŠ¸ì¸¡ì—ì„œ ì €ì¥í•˜ê³  ì‚¬ìš©í•˜ëŠ” ë°ì´í„°
    req.sessiontStore() ì‚¬ìš©í–ˆì„ë•Œ í•œë²ˆì€ undefinedê°€ ë‚˜ì˜¨ ì´ìœ ê°€ ì„¸ì…˜ì€ ì„œë²„ì—ì„œ ë§Œë“¤ì–´ì¤˜ì•¼ í•˜ëŠ”ë° í´ë¼ì´ì–¸íŠ¸ê°€ ì²« ìš”ì²­ë•Œ ì„¸ì…˜ì„ ê°€ì§€ê³ ìˆì„ë¦¬ ì—†ìœ¼ë‹ˆ undefinedì´ ë‚˜ì˜¨ê±°ê³  ê·¸ ì´í›„ ìš”ì²­ë¶€í„´ ì²«ë²ˆì§¸ ìš”ì²­ë•Œ ì„¸ì…˜ì„ ë§Œë“¤ì–´ì„œ ë„˜ê²¨ì¤¬ìœ¼ë‹ˆ í´ë¼ì´ì–¸íŠ¸ê°€ í•´ë‹¹ ê°’ì„ ì¿ í‚¤ì— ì €ì¥í•˜ê³  ë§¤ ìš”ì²­ë•Œë§ˆë‹¤ ì„œë²„ì—ê²Œ ì „ë‹¬
    ì„¸ì…˜ì€ ì„œë²„ê°€ ë§Œë“¤ì–´ì„œ ì œê³µí•´ì£¼ë‹¤ë³´ë‹ˆ ì„œë²„ê°€ ì¬ë¶€íŒ…ë˜ë©´ ì´ˆê¸°í™” ëœë‹¤. (ê·¸ë˜ì„œ DBì— ì €ì¥í•´ì„œ ê´€ë¦¬ë¥¼ í•œë‹¤ëŠ” ì†Œë¦¬. ì‹¤ ìš´ì˜ì—ì„  ì„œë²„ê°€ êº¼ì§€ëŠ” ì¼ì€ ì—†ìœ¼ë‹ˆê¹.)
    ì„¸ì…˜ì˜ ê°’ì€ ì„œë²„ê°€ ë§Œë“¤ì–´ì£¼ëŠ” ê³ ìœ ê°’ì´ë‹¤ë³´ë‹ˆ í•´ë‹¹ ê°’ì„ ê¸°ì¤€ìœ¼ë¡œ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ìš”ì²­í•œ ê±´ì— ëŒ€í•´ ìœ ì €ë¥¼ íŠ¹ì •ì§€ì„ ìˆ˜ ìˆë‹¤

#7.9 Logged In User 

    user ì •ë³´ì— sessionì„ ì¶”ê°€
    ex) userController.js
        export const postLogin = async (req, res) => {
            ...
            req.session.loggedIn = true;
            req.session.user = user;

#7.10 Logged In User part Two 

    pugì™€ expressê°€ resì˜ localsë¥¼ ê³µìœ í•˜ë„ë¡ ì„¤ì •ë˜ì–´ìˆìŒ.

    #localObject
    locals.variable ë¡œ localsdì— ë³€ìˆ˜ë¥¼ ì„ ì–¸í•˜ë©´ variableì€ ì „ì—­ë³€ìˆ˜ë¼ì„œ ì–´ë””ì„œë“  ì ‘ê·¼ì´ ê°€ëŠ¥í•¨.

    request ë²”ìœ„ê°€ ì§€ì •ëœ response ë¡œì»¬ ë³€ìˆ˜ë¥¼ í¬í•¨í•˜ëŠ” ê°ì²´ì´ë¯€ë¡œ request, response ì£¼ê¸°ë™ì•ˆ ë Œë”ë§ëœ viewì—ì„œë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    (Pugë‚˜ EJSê°™ì€ í…œí”Œë¦¿ ì—”ì§„ì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•˜ë‹¤ëŠ” ì˜ë¯¸)
    ì´ ì†ì„±ì€ request path, ì¸ì¦ëœ ì‚¬ìš©ì, ì‚¬ìš©ì ì„¤ì • ë“±ê³¼ ê°™ì€ request levelì˜ ì •ë³´ë¥¼ ë…¸ì¶œí•˜ëŠ” ë° ìœ ìš©í•©ë‹ˆë‹¤.
    https://expressjs.com/ko/api.html#res.locals
    
    ex) server.js
        app.use(function (req, res, next) {
        res.locals.user = req.user
        res.locals.authenticated = !req.user.anonymous
        next()
        })
    
#7.11 Recap

    1. backend browserê°€ ì†Œí†µí•˜ëŠ” ë°©ì‹
    backendì™€ browserëŠ” session IDë¥¼ ì €ì¥í•˜ëŠ”ë°
    browserëŠ” cookieë¼ëŠ” ê²ƒì— ì €ì¥ì„ í•˜ê³  ë‹¤ë‹Œë‹¤ ê·¸ë˜ì„œ browserê°€ backendì— ìš”ì²­í• ë•ŒëŠ” cookieë¥¼ ë³´ë‚´ê³  backendì—ì„œ session IDì˜ ìœ ë¬´ë¥¼ í™•ì¸í•œí›„ ì‘ë‹µì„ í•´ì£¼ëŠ” ë°©ì‹

    2. ë¡œê·¸ì¸ í•˜ëŠ” ë°©ë²•
    req.sessionì„ í†µí•´ session(objectë¡œ ì´ë£¨ì–´ì ¸ìˆìŒ)ì— ì ‘ê·¼ì´ ê°€ëŠ¥í•˜ë‹¤
    loggedIn = true , user = user(ì•ì„œ ë³€ìˆ˜ë¡œ ì„ ì–¸í•œ) ë¥¼ ë„£ì–´ì¤Œìœ¼ë¡œ res.localìœ¼ë¡œ ì ‘ê·¼í•´ì„œ ê°€ì ¸ì˜¬ ìˆ˜ê°€ ìˆë‹¤!

#7.12 MongoStore 

    # Express Session
    ì¿ í‚¤ì—ëŠ” ì„¸ì…˜ ë°ì´í„°ê°€ ì•„ë‹Œ ì„¸ì…˜ IDì—ë§Œ ì €ì¥ë©ë‹ˆë‹¤. ì„¸ì…˜ ë°ì´í„°ëŠ” ì„œë²„ ì¸¡ì— ì €ì¥ë©ë‹ˆë‹¤. 
    í•˜ì§€ë§Œ ê¸°ë³¸ ì„œë²„ ì¸¡ ì„¸ì…˜ ì €ì¥ì†Œì¸ MemoryStoreëŠ” production í™˜ê²½ìš©ìœ¼ë¡œ ì„¤ê³„ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.
    https://www.npmjs.com/package/express-session

    # Compatible Session Stores (í˜¸í™˜ê°€ëŠ¥í•œ ì„¸ì…˜ ìŠ¤í† ì–´)
    https://www.npmjs.com/package/express-session#compatible-session-stores

    # connect-mongo
    Typescriptë¡œ ì‘ì„±ëœ Connect ë° Expressìš© MongoDB ì„¸ì…˜ ì €ì¥ì†Œ.
    npm i connect-mongo
    https://www.npmjs.com/package/connect-mongo

    server.js íŒŒì¼ì— import í•˜ê³ 
    import MongoStore from "connect-mongo";

    ì•„ë˜ì™€ ê°™ì´ use( session ë‚´ë¶€ì— ì¶”ê°€í•´ì¤€ë‹¤
    app.use(
        session({
            store: MongoStore.create({ mongoUrl: "mongodb://127.0.0.1:27017/wetube" }),
        })
    );

    ì„¸ì…˜ì€ ë¸Œë¼ìš°ì €ê°€ backendì— ë°©ë¬¸í• ë•Œ ìƒì„±ëœë‹¤.

#7.13 Uninitialized Sessions    

    í˜„ì‹¤ì ìœ¼ë¡œ ëª¨ë“  ë°©ë¬¸ìì— ëŒ€í•œ ì„¸ì…˜ì„ ì €ì¥í•  ìˆ˜ëŠ” ì—†ë‹¤. 
    ë”°ë¼ì„œ ë¡œê·¸ì¸ í•œ ì‚¬ëŒì—ê²Œë§Œ ì €ì¥í•˜ëŠ” ë°©ë²•ì„ ì‚¬ìš©.
    ex) server.js
        app.use(
            session({
                resave: false,
                saveUninitialized: false,
                
            })
        );
        
    * resave : ëª¨ë“  requestë§ˆë‹¤ ì„¸ì…˜ì˜ ë³€ê²½ì‚¬í•­ì´ ìˆë“  ì—†ë“  ì„¸ì…˜ì„ ë‹¤ì‹œ ì €ì¥í•œë‹¤.
        - true:
        => ìŠ¤í† ì–´ì—ì„œ ì„¸ì…˜ ë§Œë£Œì¼ìë¥¼ ì—…ë°ì´íŠ¸ í•´ì£¼ëŠ” ê¸°ëŠ¥ì´ ë”°ë¡œ ì—†ìœ¼ë©´ trueë¡œ ì„¤ì •í•˜ì—¬ ë§¤ requestë§ˆë‹¤ ì„¸ì…˜ì„ ì—…ë°ì´íŠ¸ í•´ì£¼ê²Œ í•œë‹¤.
        - false:
        => ë³€ê²½ì‚¬í•­ì´ ì—†ìŒì—ë„ ì„¸ì…˜ì„ ì €ì¥í•˜ë©´ ë¹„íš¨ìœ¨ì ì´ë¯€ë¡œ ë™ì‘ íš¨ìœ¨ì„ ë†’ì´ê¸° ìœ„í•´ ì‚¬ìš©í•œë‹¤.
        => ê°ê° ë‹¤ë¥¸ ë³€ê²½ì‚¬í•­ì„ ìš”êµ¬í•˜ëŠ” ë‘ ê°€ì§€ requestë¥¼ ë™ì‹œì— ì²˜ë¦¬í• ë•Œ ì„¸ì…˜ì„ ì €ì¥í•˜ëŠ” ê³¼ì •ì—ì„œ ì¶©ëŒì´ ë°œìƒí•  ìˆ˜ ìˆëŠ”ë° ì´ë¥¼ ë°©ì§€í•˜ê¸°ìœ„í•´ ì‚¬ìš©í•œë‹¤.


    * saveUninitialized : uninitialized ìƒíƒœì¸ ì„¸ì…˜ì„ ì €ì¥í•œë‹¤. ì—¬ê¸°ì„œ uninitialized ìƒíƒœì¸ ì„¸ì…˜ì´ë€ request ë•Œ ìƒì„±ëœ ì´í›„ë¡œ ì•„ë¬´ëŸ° ì‘ì—…ì´ ê°€í•´ì§€ì§€ì•ŠëŠ” ì´ˆê¸°ìƒíƒœì˜ ì„¸ì…˜ì„ ë§í•œë‹¤.
        - true:
        => í´ë¼ì´ì–¸íŠ¸ë“¤ì´ ì„œë²„ì— ë°©ë¬¸í•œ ì´ íšŸìˆ˜ë¥¼ ì•Œê³ ì í• ë•Œ ì‚¬ìš©í•œë‹¤.
        - false:
        => uninitialized ìƒíƒœì¸ ì„¸ì…˜ì„ ê°•ì œë¡œ ì €ì¥í•˜ë©´ ë‚´ìš©ë„ ì—†ëŠ” ë¹ˆ ì„¸ì…˜ì´ ìŠ¤í† ë¦¬ì§€ì— ê³„ì† ìŒ“ì¼ìˆ˜ ìˆë‹¤. ì´ë¥¼ ë°©ì§€, ì €ì¥ê³µê°„ì„ ì•„ë¼ê¸° ìœ„í•´ ì‚¬ìš©í•œë‹¤.

#7.14 Expiration and Secrets

    # Set-Cookie
        Set-Cookie HTTP ì‘ë‹µ í—¤ë”ëŠ” ì„œë²„ì—ì„œ ì‚¬ìš©ì ë¸Œë¼ìš°ì €ì— ì¿ í‚¤ë¥¼ ì „ì†¡í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë©ë‹ˆë‹¤.
        https://developer.mozilla.org/ko/docs/Web/HTTP/Headers/Set-Cookie

    # ì¿ í‚¤ì— ì„¤ì •ê°€ëŠ¥í•œ ì˜µì…˜
        Domain
        ì¿ í‚¤ê°€ ì ìš©ë˜ì–´ì•¼ í•˜ëŠ” í˜¸ìŠ¤íŠ¸ë¥¼ ì§€ì •.

        Expires
        HTTP íƒ€ì„ìŠ¤í…œí”„ë¡œ ê¸°ë¡ëœ ì¿ í‚¤ì˜ ìµœëŒ€ ìƒì¡´ ì‹œê°„(ìˆ˜ëª…).

        Max-Age
        ì¿ í‚¤ê°€ ë§Œë£Œë  ë•Œ ê¹Œì§€ì˜ ì‹œê°„ (ë°€ë¦¬ì„¸ì»¨ë“œ)


    # secret
    ì´ê²ƒì€ ì„¸ì…˜ ID ì¿ í‚¤ì— ì„œëª…í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” ë¹„ë°€ì…ë‹ˆë‹¤.
    https://www.npmjs.com/package/express-session

    secretê³¼ urlì˜ stringì„ ê³µê°œí•˜ê³  ì‹¶ì§€ ì•Šì„ë•Œ ã„·nvironment file(í™˜ê²½ë³€ìˆ˜)ë¥¼ ì‚¬ìš©
    .env íŒŒì¼ì„ root í´ë” ë°”ë¡œ í•˜ìœ„ì— ë§Œë“¤ê³  .gitigoreì— ì¶”ê°€
    ê´€ìŠµì ìœ¼ë¡œ envíŒŒì¼ì˜ ëª¨ë“  ë¬¸ìëŠ” ëŒ€ë¬¸ìë¡œ ì ëŠ”ë‹¤.
    ex) .env
        COOKIE_SECRET=askdhf8913fnasdf0n198fh283fads9fhj01
        DB_URL=mongodb://127.0.0.1:27017/wetube

    ì‚¬ìš©
    ex)
        process.env.DB_URL

#7.15 Environment Variables 

    í™˜ê²½ë³€ìˆ˜ ì½ê¸°ìœ„í•œ ë°©ë²•
    1. npm i dotenv
    2. ê°€ëŠ¥í•œ í•œ ê°€ì¥ ë¨¼ì € ì‚¬ìš©í•˜ê¸° require("dotenv").config()
    2-1)ì‚¬ìš©í•  ëª¨ë“  íŒŒì¼ì— require("dotenv").config() ë¶™ì´ê¸°
    requirë¥¼ ì‚¬ìš©í–ˆì„ë• ëª¨ë“  íŒŒì¼ì— ë‹¤ require ì„ ì–¸ì„ í•´ì¤˜ì•¼í•¨. ë”°ë¼ì„œ importë¡œ ì‚¬ìš©
    2-2)require("dotenv").config() -> import "dotenv/config" ë³€í™˜ í›„ init.jsì— ë„£ì–´ì£¼ê¸°
    (why init.js? -> devë¥¼ ì‹¤í–‰í•˜ë©´ init.jsê°€ ì œì¼ ë¨¼ì € ì‹¤í–‰ë˜ê¸° ë•Œë¬¸)

#7.16 Github Login part One

    # Authorizing OAuth Apps
        ë‹¤ë¥¸ ì‚¬ìš©ìê°€ OAuth ì•±ì„ ìŠ¹ì¸í•˜ë„ë¡ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        GitHubì˜ OAuth êµ¬í˜„ì€ ì›¹ ë¸Œë¼ìš°ì €ì— ëŒ€í•œ ì•¡ì„¸ìŠ¤ ê¶Œí•œì´ ì—†ëŠ” ì•±ì— ëŒ€í•œ í‘œì¤€ ì¸ì¦ ì½”ë“œ ë¶€ì—¬ ìœ í˜• ë° OAuth 2.0 ì¥ì¹˜ ì¸ì¦ ë¶€ì—¬ë¥¼ ì§€ì›í•©ë‹ˆë‹¤.

    1. ì‚¬ìš©ìë¥¼ Githubìœ¼ë¡œ redirect ì‹œí‚¨ë‹¤.
    2. ìŠ¹ì¸ë˜ëŠ”ìˆœê°„ tokenê³¼ í•¨ê»˜ ì›¹ì‚¬ì´íŠ¸ë¡œ redirect
    3. ì‚¬ìš©ìì˜ ì •ë³´ì— ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤.

    github.com/settings/apps ë¡œ ì´ë™ í›„ OAuth
    Authorization callback URLì— ì•„ë˜ì™€ ê°™ì´ ì…ë ¥(ë„ë©”ì¸ ë’¤ì—ëŠ” ì•„ë¬´ê±°ë‚˜ í•´ë„ ë˜ì§€ë§Œ ê¸°ì–µí•  ë§Œí•œ ê²ƒìœ¼ë¡œ í•´ì•¼í•¨)
    http://localhost:5000/users/github/callback

    ë” ë§ì€ ì •ë³´ë¥¼ githubë¡œë¶€í„° ì–»ê¸° ìœ„í•´ scopeë¥¼ ì‚¬ìš©í•œë‹¤.
    ê¸°ì¡´ íšŒì›ë§Œ ì‚¬ìš©í•˜ê²Œ í•˜ëŠ” ë°©ë²•ì€ id ë’¤ì— allow_signup = false 
    ex) login.pug        
        a(href="https://github.com/login/oauth/authorize?client_id=51823aaf4011e042c5cc&&allow_signup = false") Continue with Github &rarr;

    # ê¹ƒí—ˆë¸Œ OAuth Apps Setting
        GitHub APIë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ ë“±ë¡í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ì…ë‹ˆë‹¤.
        https://github.com/settings/developers

    # Scopes for OAuth Apps (OAuth ì•±ì˜ ë²”ìœ„)
        https://docs.github.com/en/developers/apps/building-oauth-apps/scopes-for-oauth-apps

    # Creating an OAuth App (OAuthì•± ë§Œë“¤ê¸°)
        https://docs.github.com/en/developers/apps/building-oauth-apps/creating-an-oauth-app

#7.17 Github Login part Two

    scope=user:email ê³¼ ê°™ì´ ë‹¤ë¥¸ ì •ë³´ë¥¼ ë°›ì•„ì˜¬ ìˆ˜ë„ ìˆìŒ.
    ex) login.pug
        a(href="https://github.com/login/oauth/authorize?client_id=51823aaf4011e042c5cc&&allow_signup = false&scope=user:email") Continue with Github &rarr;

    # Scopes for OAuth Apps
    OAuth ì•±ì€ ì´ˆê¸° ë¦¬ë””ë ‰ì…˜ì—ì„œ ë²”ìœ„ë¥¼ ìš”ì²­í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. %20ì„ ì‚¬ìš©í•˜ì—¬ ê³µë°±ìœ¼ë¡œ êµ¬ë¶„í•˜ì—¬ ì—¬ëŸ¬ ë²”ìœ„ë¥¼ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    https://docs.github.com/en/developers/apps/building-oauth-apps/scopes-for-oauth-apps
    ex)
        https://github.com/login/oauth/authorize?client_id=...&scope=user%20repo_deployment
    
#7.18 Github Login part Three 

    githubì—ì„œ ì¤€ ì½”ë“œë¥¼ Access tokenìœ¼ë¡œ ë°”ê¿”ì¤˜ì•¼í•¨.

    client_idë¥¼ envë¡œ í•˜ëŠ” ì´ìœ ëŠ” í•œê³³ì— ëª¨ì•„ë†“ê³  ì–´ë””ì„œë“  ì“°ê¸° ìœ„í•¨.

    Users are redirected back to your site by GitHub

    ì‚¬ìš©ìê°€ ìš”ì²­ì„ ìˆ˜ë½í•˜ë©´ GitHubëŠ” ì½”ë“œ ë§¤ê°œë³€ìˆ˜ì˜ ì„ì‹œ codeì™€ ìƒíƒœ ë§¤ê°œë³€ìˆ˜ì˜ ì´ì „ ë‹¨ê³„ì—ì„œ ì œê³µí•œ stateë¥¼ ì‚¬ìš©í•˜ì—¬ ì‚¬ì´íŠ¸ë¡œ ë‹¤ì‹œ ë¦¬ë””ë ‰ì…˜í•©ë‹ˆë‹¤.

    POST Requestë¥¼ í•  ë•Œ, ë°˜ë“œì‹œ í•„ìš”í•œ íŒŒë¼ë¯¸í„°ë“¤
    client_id, client_secret, code
    ```
    POST https://github.com/login/oauth/access_token
    ```
    https://docs.github.com/en/developers/apps/building-oauth-apps/authorizing-oauth-apps#2-users-are-redirected-back-to-your-site-by-github

    backendì™€ frontend ë‘˜ë‹¤ ì‚¬ìš©í•  ìˆ˜ ì—†ëŠ” í•¨ìˆ˜ë“¤ì´ ìˆë‹¤.

    #fetch
    1. fetch('url')ë¡œ ë‹¤ë¥¸ ì„œë²„ë¥¼ í†µí•´ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ìˆë‹¤.
    í•˜ì§€ë§Œ, res.body ì— ë‹´ê²¨ìˆëŠ” ë‚ ê²ƒì˜ urlë¡œëŠ” ì œëŒ€ë¡œ ëœ ê°ì²´ë¥¼ ë°›ì•„ì˜¬ ìˆ˜ ì—†ë‹¤.

    2.ë•Œë¬¸ì— ì¤‘ê°„ì— .json í•¨ìˆ˜ê°€ responseì˜ ìŠ¤íŠ¸ë¦¼ì„ ê°€ì ¸ì™€ ëê¹Œì§€ ì½ê³ , res.bodyì˜ í…ìŠ¤íŠ¸ë¥¼ promiseì˜ í˜•íƒœë¡œ ë°˜í™˜í•œë‹¤.

    ex) userController.js
        const tokenRequest = await (
            await fetch(finalUrl, {
                method: "POST",
                headers: {
                    Accept: "application/json",
                },
            })
        ).json();

#7.19 Github Login part Four

    nodejs 18.0.0 ë¶€í„°ëŠ” fetch ê¸°ëŠ¥ íƒ‘ì¬ë˜ì–´ìˆìŒ.
    HTTP headers (fetchì˜ headerì˜ ì—­í• )

    HTTP headersëŠ” ëŠ” í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ê°€ request(or response)ë¡œ ë¶€ê°€ì ì¸ ì •ë³´ë¥¼ ì „ì†¡í•  ìˆ˜ ìˆë„ë¡ í•´ì¤ë‹ˆë‹¤

    Accept
    ëŒë ¤ì¤„ ë°ì´í„° íƒ€ì…ì— ëŒ€í•´ ì„œë²„ì—ê²Œ ì•Œë ¤ì£¼ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤
    MIME íƒ€ì…ì…ë‹ˆë‹¤
    (ğŸ“ŒMIME typeì´ë€ ì›¹ì—ì„œ ì‚¬ìš©ë˜ëŠ” í™•ì¥ìë¼ê³  ìƒê°í•˜ì‹œë©´ ë˜ë©°
    type/subtypeìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤)

    Authorization
    ë³´í˜¸ëœ ë¦¬ì†ŒìŠ¤ì— ëŒ€í•œ ì ‘ê·¼ì„ í—ˆìš©í•˜ì—¬ ì„œë²„ë¡œ User agentë¥¼ ì¸ì¦í•˜ëŠ” ìê²©ì¦ëª…ì„ ë³´ë‚´ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤

    [ì¶œì²˜]
    HTTP headers: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers
    MIME tyeps: https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types

#7.20 Github Login part Five 

    